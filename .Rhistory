## Read in the tsv file with the quicksand data for all samples
dt.tax <- fread('data/env_samples/quicksand.v2/final_report.tsv', na.strings = c('-','NA',''))
## Apply the cap to ReadsDeduped
dt.tax[, ReadsDeduped.cap := pmin(ReadsDeduped, 20000)]
## Merge dt.tax with dt.dog_office to include category information
dt.tax_filtered <- merge(dt.tax, dt.dog_office[, .(sample_id, category, category2)], by="sample_id", all.x=TRUE)
## Split dog_office data
dt.tax_filtered[, is_dog_office := ifelse(category2 == "dog_office", "Dog Office", "Non-Dog Office")]
## Filter for only Human (Hominidae) and Dog (Canidae) families
relevant_families <- c('Hominidae', 'Canidae')
dt.tax_filtered <- dt.tax_filtered[Family %in% relevant_families]
## Add wall information
dt.tax_filtered[, is_wall := ifelse(category == "wall", "Wall", "Other")]
## Function to create boxplot
create_boxplot <- function(data, x_var, y_var, fill_var, title) {
ggplot(data, aes(x = .data[[x_var]], y = .data[[y_var]], fill = .data[[fill_var]])) +
geom_boxplot() +
geom_point(position = position_jitterdodge(), alpha = 0.5) +
stat_summary(fun = median, geom = "point", shape = 18, size = 3, color = "black") +
theme_minimal() +
labs(title = title, x = x_var, y = y_var) +
theme(legend.position = "bottom")
}
## Create plots
plot_dog_office <- create_boxplot(dt.tax_filtered, "Family", "ReadsDeduped.cap", "is_dog_office", "Dog Office vs Non-Dog Office")
plot_wall <- create_boxplot(dt.tax_filtered, "Family", "ReadsDeduped.cap", "is_wall", "Wall vs Other Locations")
## Combine plots
combined_plot <- grid.arrange(plot_dog_office, plot_wall, ncol = 2)
## Save combined plot
ggsave("figures/combined_boxplots.png", combined_plot, width = 16, height = 8)
library(data.table)
library(ggplot2)
library(gridExtra)
## Set working directory
setwd("~/github/mpi_dogs/")
## Read in the txt file with dog office and category information
dt.dog_office <- fread('data/dog_samples/R_prep/dog_env_samples_24_v1.txt', na.strings = c('-','NA',''))
## Read in the tsv file with the quicksand data for all samples
dt.tax <- fread('data/env_samples/quicksand.v2/final_report.tsv', na.strings = c('-','NA',''))
## Apply the cap to ReadsDeduped
dt.tax[, ReadsDeduped.cap := pmin(ReadsDeduped, 20000)]
## Merge dt.tax with dt.dog_office to include category information
dt.tax_filtered <- merge(dt.tax, dt.dog_office[, .(sample_id, category, category2)], by="sample_id", all.x=TRUE)
## Filter for only Human (Hominidae) and Dog (Canidae) families
relevant_families <- c('Hominidae', 'Canidae')
dt.tax_filtered <- dt.tax_filtered[Family %in% relevant_families]
## Add wall information
dt.tax_filtered[, is_wall := ifelse(category == "wall", "Wall", "Other")]
## Function to create boxplot
create_boxplot <- function(data, title) {
ggplot(data, aes(x = Family, y = ReadsDeduped.cap, fill = is_wall)) +
geom_boxplot() +
geom_point(position = position_jitterdodge(), alpha = 0.5) +
stat_summary(fun = median, geom = "point", shape = 18, size = 3, color = "black") +
theme_minimal() +
labs(title = title, x = "Family", y = "ReadsDeduped (capped)") +
theme(legend.position = "bottom")
}
## Create separate plots for dog_office and non-dog_office
plot_dog_office <- create_boxplot(dt.tax_filtered[category2 == "dog_office"], "Dog Office: Wall vs Other")
plot_non_dog_office <- create_boxplot(dt.tax_filtered[category2 != "dog_office"], "Non-Dog Office: Wall vs Other")
## Combine plots
combined_plot <- grid.arrange(plot_dog_office, plot_non_dog_office, ncol = 2)
## Save combined plot
ggsave("figures/combined_boxplots_wall_comparison.png", combined_plot, width = 16, height = 8)
## Set working directory
setwd("~/github/mpi_dogs/")
## Read in the txt file with dog office and category information
dt.dog_office <- fread('data/dog_samples/R_prep/dog_env_samples_24_v1.txt', na.strings = c('-','NA',''))
## Read in the tsv file with the quicksand data for all samples
dt.tax <- fread('data/env_samples/quicksand.v2/final_report.tsv', na.strings = c('-','NA',''))
## Apply the cap to ReadsDeduped
dt.tax[, ReadsDeduped.cap := pmin(ReadsDeduped, 20000)]
## Merge dt.tax with dt.dog_office to include category information
dt.tax_filtered <- merge(dt.tax, dt.dog_office[, .(sample_id, category, category2)], by="sample_id", all.x=TRUE)
## Filter for only Human (Hominidae) and Dog (Canidae) families
relevant_families <- c('Hominidae', 'Canidae')
dt.tax_filtered <- dt.tax_filtered[Family %in% relevant_families]
## Add wall information
dt.tax_filtered[, is_wall := ifelse(category == "wall", "Wall", "Other")]
## Function to create boxplot
create_boxplot <- function(data, title) {
ggplot(data, aes(x = Family, y = ReadsDeduped.cap, fill = is_wall)) +
geom_boxplot() +
geom_point(position = position_jitterdodge(), alpha = 0.5) +
stat_summary(fun = median, geom = "point", shape = 18, size = 3, color = "black") +
theme_minimal() +
labs(title = title, x = "Family", y = "ReadsDeduped (capped)") +
theme(legend.position = "bottom")
}
## Create separate plots for dog_office and non-dog_office
plot_dog_office <- create_boxplot(dt.tax_filtered[category2 == "dog_office"], "Dog Office: Wall vs Other")
plot_non_dog_office <- create_boxplot(dt.tax_filtered[category2 != "dog_office"], "Non-Dog Office: Wall vs Other")
## Combine plots
combined_plot <- grid.arrange(plot_dog_office, plot_non_dog_office, ncol = 2)
## Set working directory
setwd("~/github/mpi_dogs/")
## Read in the txt file with dog office and category information
dt.dog_office <- fread('data/dog_samples/R_prep/dog_env_samples_24_v1.txt', na.strings = c('-','NA',''))
## Read in the tsv file with the quicksand data for all samples
dt.tax <- fread('data/env_samples/quicksand.v2/final_report.tsv', na.strings = c('-','NA',''))
## Apply the cap to ReadsDeduped
dt.tax[, ReadsDeduped.cap := pmin(ReadsDeduped, 20000)]
## Merge dt.tax with dt.dog_office to include category information
dt.tax_filtered <- merge(dt.tax, dt.dog_office[, .(sample_id, category, category2)], by="sample_id", all.x=TRUE)
## Filter for only Human (Hominidae) and Dog (Canidae) families
relevant_families <- c('Hominidae', 'Canidae')
dt.tax_filtered <- dt.tax_filtered[Family %in% relevant_families]
## Add wall information
dt.tax_filtered[, is_wall := ifelse(category == "wall", "Wall", "Other")]
## Function to create boxplot
create_boxplot <- function(data, title) {
ggplot(data, aes(x = Family, y = ReadsDeduped.cap, fill = is_wall)) +
geom_boxplot() +
geom_point(position = position_jitterdodge(), alpha = 0.5) +
stat_summary(fun = median, geom = "point", shape = 18, size = 3, color = "black") +
theme_minimal() +
labs(title = title, x = "Family", y = "ReadsDeduped (capped)") +
theme(legend.position = "bottom")
}
## Create separate plots for dog_office and non-dog_office
plot_dog_office <- create_boxplot(dt.tax_filtered[category2 == "dog_office"], "Dog Office: Wall vs Other")
plot_non_dog_office <- create_boxplot(dt.tax_filtered[category2 != "dog_office"], "Non-Dog Office: Wall vs Other")
## Combine plots
combined_plot <- grid.arrange(plot_dog_office, plot_non_dog_office, ncol = 2)
## Set working directory
setwd("~/github/mpi_dogs/")
## Read in the txt file with dog office and category information
dt.dog_office <- fread('data/dog_samples/R_prep/dog_env_samples_24_v1.txt', na.strings = c('-','NA',''))
## Read in the tsv file with the quicksand data for all samples
dt.tax <- fread('data/env_samples/quicksand.v2/final_report.tsv', na.strings = c('-','NA',''))
## Apply the cap to ReadsDeduped
dt.tax[, ReadsDeduped.cap := pmin(ReadsDeduped, 20000)]
## Merge dt.tax with dt.dog_office to include category information
dt.tax_filtered <- merge(dt.tax, dt.dog_office[, .(sample_id, category, category2)], by="sample_id", all.x=TRUE)
## Filter for only Human (Hominidae) and Dog (Canidae) families
relevant_families <- c('Hominidae', 'Canidae')
dt.tax_filtered <- dt.tax_filtered[Family %in% relevant_families]
## Add wall information and rename families
dt.tax_filtered[, `:=`(
is_wall = ifelse(category == "wall", "Wall", "No Wall"),
Species = ifelse(Family == "Hominidae", "Human", "Dog")
)]
## Function to create boxplot
create_boxplot <- function(data, title) {
ggplot(data, aes(x = is_wall, y = ReadsDeduped.cap, fill = Species)) +
geom_boxplot() +
geom_point(position = position_jitterdodge(), alpha = 0.5) +
stat_summary(fun = median, geom = "point", shape = 18, size = 3, color = "black") +
theme_minimal() +
labs(title = title, x = "Sample Location", y = "ReadsDeduped (capped)") +
theme(legend.position = "bottom")
}
## Create separate plots for dog_office and non-dog_office
plot_dog_office <- create_boxplot(dt.tax_filtered[category2 == "dog_office"], "Dog Office: Wall vs No Wall")
plot_non_dog_office <- create_boxplot(dt.tax_filtered[category2 != "dog_office"], "Non-Dog Office: Wall vs No Wall")
## Combine plots
combined_plot <- grid.arrange(plot_dog_office, plot_non_dog_office, ncol = 2)
## Set working directory
setwd("~/github/mpi_dogs/")
## Read in the txt file with dog office and category information
dt.dog_office <- fread('data/dog_samples/R_prep/dog_env_samples_24_v1.txt', na.strings = c('-','NA',''))
## Read in the tsv file with the quicksand data for all samples
dt.tax <- fread('data/env_samples/quicksand.v2/final_report.tsv', na.strings = c('-','NA',''))
## Apply the cap to ReadsDeduped
dt.tax[, ReadsDeduped.cap := pmin(ReadsDeduped, 20000)]
## Merge dt.tax with dt.dog_office to include category information
dt.tax_filtered <- merge(dt.tax, dt.dog_office[, .(sample_id, category, category2)], by="sample_id", all.x=TRUE)
## Filter for only Human (Hominidae) and Dog (Canidae) families
relevant_families <- c('Hominidae', 'Canidae')
dt.tax_filtered <- dt.tax_filtered[Family %in% relevant_families]
## Add wall information and rename families, treating empty categories as "No Wall"
dt.tax_filtered[, `:=`(
is_wall = ifelse(category == "wall", "Wall", "No Wall"),
Species = ifelse(Family == "Hominidae", "Human", "Dog")
)]
dt.tax_filtered[is.na(is_wall) | is_wall == "", is_wall := "No Wall"]
## Function to create boxplot
create_boxplot <- function(data, title) {
ggplot(data, aes(x = is_wall, y = ReadsDeduped.cap, fill = Species)) +
geom_boxplot() +
geom_point(position = position_jitterdodge(), alpha = 0.5) +
stat_summary(fun = median, geom = "point", shape = 18, size = 3, color = "black") +
theme_minimal() +
labs(title = title, x = "Sample Location", y = "ReadsDeduped (capped)") +
theme(legend.position = "bottom")
}
## Create separate plots for dog_office and non-dog_office
plot_dog_office <- create_boxplot(dt.tax_filtered[category2 == "dog_office"], "Dog Office: Wall vs No Wall")
plot_non_dog_office <- create_boxplot(dt.tax_filtered[category2 != "dog_office"], "Non-Dog Office: Wall vs No Wall")
## Combine plots
combined_plot <- grid.arrange(plot_dog_office, plot_non_dog_office, ncol = 2)
## Save combined plot
ggsave("figures/combined_boxplots_wall_comparison.png", combined_plot, width = 16, height = 8)
## Function to create boxplot
create_boxplot <- function(data, title) {
ggplot(data, aes(x = is_wall, y = ReadsDeduped.cap, fill = Species)) +
geom_boxplot() +
geom_point(position = position_jitterdodge(), alpha = 0.5) +
stat_summary(fun = median, geom = "point", shape = 18, size = 3, color = "black") +
theme_minimal() +
labs(title = title, x = "Sample Location", y = "ReadsDeduped (capped)") +
theme(legend.position = "bottom")
geom_jitter()
}
## Create separate plots for dog_office and non-dog_office
plot_dog_office <- create_boxplot(dt.tax_filtered[category2 == "dog_office"], "Dog Office: Wall vs No Wall")
plot_non_dog_office <- create_boxplot(dt.tax_filtered[category2 != "dog_office"], "Non-Dog Office: Wall vs No Wall")
## Combine plots
combined_plot <- grid.arrange(plot_dog_office, plot_non_dog_office, ncol = 2)
rlang::last_trace()
## Set working directory
setwd("~/github/mpi_dogs/")
## Read in the txt file with dog office and category information
dt.dog_office <- fread('data/dog_samples/R_prep/dog_env_samples_24_v1.txt', na.strings = c('-','NA',''))
## Read in the tsv file with the quicksand data for all samples
dt.tax <- fread('data/env_samples/quicksand.v2/final_report.tsv', na.strings = c('-','NA',''))
## Apply the cap to ReadsDeduped
dt.tax[, ReadsDeduped.cap := pmin(ReadsDeduped, 20000)]
## Merge dt.tax with dt.dog_office to include category information
dt.tax_filtered <- merge(dt.tax, dt.dog_office[, .(sample_id, category, category2)], by="sample_id", all.x=TRUE)
## Filter for only Human (Hominidae) and Dog (Canidae) families
relevant_families <- c('Hominidae', 'Canidae')
dt.tax_filtered <- dt.tax_filtered[Family %in% relevant_families]
## Add wall information and rename families, treating empty categories as "No Wall"
dt.tax_filtered[, `:=`(
is_wall = ifelse(category == "wall", "Wall", "No Wall"),
Species = ifelse(Family == "Hominidae", "Human", "Dog")
)]
dt.tax_filtered[is.na(is_wall) | is_wall == "", is_wall := "No Wall"]
## Function to create boxplot with jitter
create_boxplot_with_jitter <- function(data, title) {
ggplot(data, aes(x = is_wall, y = ReadsDeduped.cap, fill = Species)) +
geom_boxplot(alpha = 0.7, outlier.shape = NA) +  # Set outlier.shape to NA to remove boxplot outliers
geom_jitter(aes(color = Species), width = 0.2, alpha = 0.5) +  # Add jitter plot
stat_summary(fun = median, geom = "point", shape = 18, size = 3, color = "black") +
theme_minimal() +
labs(title = title, x = "Sample Location", y = "ReadsDeduped (capped)") +
theme(legend.position = "bottom")
}
## Create separate plots for dog_office and non-dog_office
plot_dog_office <- create_boxplot_with_jitter(dt.tax_filtered[category2 == "dog_office"], "Dog Office: Wall vs No Wall")
plot_non_dog_office <- create_boxplot_with_jitter(dt.tax_filtered[category2 != "dog_office"], "Non-Dog Office: Wall vs No Wall")
## Combine plots
combined_plot <- grid.arrange(plot_dog_office, plot_non_dog_office, ncol = 2)
## Read in the txt file with dog office and category information
dt.dog_office <- fread('data/dog_samples/R_prep/dog_env_samples_24_v1.txt', na.strings = c('-','NA',''))
## Read in the tsv file with the quicksand data for all samples
dt.tax <- fread('data/env_samples/quicksand.v2/final_report.tsv', na.strings = c('-','NA',''))
## Apply the cap to ReadsDeduped
dt.tax[, ReadsDeduped.cap := pmin(ReadsDeduped, 20000)]
## Merge dt.tax with dt.dog_office to include category information
dt.tax_filtered <- merge(dt.tax, dt.dog_office[, .(sample_id, category, category2)], by="sample_id", all.x=TRUE)
## Filter for only Human (Hominidae) and Dog (Canidae) families
relevant_families <- c('Hominidae', 'Canidae')
dt.tax_filtered <- dt.tax_filtered[Family %in% relevant_families]
## Add wall information and rename families, treating empty categories as "No Wall"
dt.tax_filtered[, `:=`(
is_wall = ifelse(category == "wall", "Wall", "No Wall"),
Species = ifelse(Family == "Hominidae", "Human", "Dog")
)]
dt.tax_filtered[is.na(is_wall) | is_wall == "", is_wall := "No Wall"]
## Function to create boxplot with jitter
create_boxplot_with_jitter <- function(data, title) {
ggplot(data, aes(x = interaction(is_wall, Species), y = ReadsDeduped.cap, fill = Species)) +
geom_boxplot(alpha = 0.7, outlier.shape = NA) +
geom_jitter(aes(color = Species), position = position_jitterdodge(dodge.width = 0.75, jitter.width = 0.2), alpha = 0.5) +
stat_summary(fun = median, geom = "point", shape = 18, size = 3, color = "black") +
theme_minimal() +
labs(title = title, x = "Sample Location", y = "ReadsDeduped (capped)") +
theme(legend.position = "bottom", axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_x_discrete(labels = c("Wall", "No Wall", "Wall", "No Wall"))
}
## Create separate plots for dog_office and non-dog_office
plot_dog_office <- create_boxplot_with_jitter(dt.tax_filtered[category2 == "dog_office"], "Dog Office: Wall vs No Wall")
plot_non_dog_office <- create_boxplot_with_jitter(dt.tax_filtered[category2 != "dog_office"], "Non-Dog Office: Wall vs No Wall")
## Combine plots
combined_plot <- grid.arrange(plot_dog_office, plot_non_dog_office, ncol = 2)
## Save combined plot
ggsave("figures/combined_boxplots_jitter_wall_comparison.png", combined_plot, width = 16, height = 8)
## Set working directory
setwd("~/github/mpi_dogs/")
## Read in the txt file with dog office and category information
dt.dog_office <- fread('data/dog_samples/R_prep/dog_env_samples_24_v1.txt', na.strings = c('-','NA',''))
## Read in the tsv file with the quicksand data for all samples
dt.tax <- fread('data/env_samples/quicksand.v2/final_report.tsv', na.strings = c('-','NA',''))
## Apply the cap to ReadsDeduped
dt.tax[, ReadsDeduped.cap := pmin(ReadsDeduped, 20000)]
## Merge dt.tax with dt.dog_office to include category information
dt.tax_filtered <- merge(dt.tax, dt.dog_office[, .(sample_id, category, category2)], by="sample_id", all.x=TRUE)
## Filter for only Human (Hominidae) and Dog (Canidae) families
relevant_families <- c('Hominidae', 'Canidae')
dt.tax_filtered <- dt.tax_filtered[Family %in% relevant_families]
## Add wall information and rename families, treating empty categories as "No Wall"
dt.tax_filtered[, `:=`(
is_wall = ifelse(category == "wall", "Wall", "No Wall"),
Species = ifelse(Family == "Hominidae", "Human", "Dog")
)]
dt.tax_filtered[is.na(is_wall) | is_wall == "", is_wall := "No Wall"]
## Function to create boxplot with jitter
create_boxplot_with_jitter <- function(data, title) {
ggplot(data, aes(x = is_wall, y = ReadsDeduped.cap, fill = Species)) +
geom_boxplot(position = position_dodge(width = 0.8), width = 0.7, alpha = 0.7, outlier.shape = NA) +
geom_jitter(aes(color = Species), position = position_jitterdodge(dodge.width = 0.8, jitter.width = 0.2), alpha = 0.5) +
stat_summary(fun = median, geom = "point", shape = 18, size = 3, color = "black", position = position_dodge(width = 0.8)) +
theme_minimal() +
labs(title = title, x = "Sample Location", y = "ReadsDeduped (capped)") +
theme(legend.position = "bottom")
}
## Create separate plots for dog_office and non-dog_office
plot_dog_office <- create_boxplot_with_jitter(dt.tax_filtered[category2 == "dog_office"], "Dog Office: Wall vs No Wall")
plot_non_dog_office <- create_boxplot_with_jitter(dt.tax_filtered[category2 != "dog_office"], "Non-Dog Office: Wall vs No Wall")
## Combine plots
combined_plot <- grid.arrange(plot_dog_office, plot_non_dog_office, ncol = 2)
## Set working directory
setwd("~/github/mpi_dogs/")
## Read in the txt file with dog office and category information
dt.dog_office <- fread('data/dog_samples/R_prep/dog_env_samples_24_v1.txt', na.strings = c('-','NA',''))
## Read in the tsv file with the quicksand data for all samples
dt.tax <- fread('data/env_samples/quicksand.v2/final_report.tsv', na.strings = c('-','NA',''))
## Apply the cap to ReadsDeduped
dt.tax[, ReadsDeduped.cap := pmin(ReadsDeduped, 20000)]
## Merge dt.tax with dt.dog_office to include category information
dt.tax_filtered <- merge(dt.tax, dt.dog_office[, .(sample_id, category, category2)], by="sample_id", all.x=TRUE)
## Filter for only Human (Hominidae) and Dog (Canidae) families
relevant_families <- c('Hominidae', 'Canidae')
dt.tax_filtered <- dt.tax_filtered[Family %in% relevant_families]
## Add wall information and rename families, treating empty categories as "No Wall"
dt.tax_filtered[, `:=`(
is_wall = ifelse(category == "wall", "Wall", "No Wall"),
Species = ifelse(Family == "Hominidae", "Human", "Dog")
)]
dt.tax_filtered[is.na(is_wall) | is_wall == "", is_wall := "No Wall"]
## Function to create boxplot without jitter
create_boxplot <- function(data, title) {
ggplot(data, aes(x = is_wall, y = ReadsDeduped.cap, fill = Species)) +
geom_boxplot(position = position_dodge(width = 0.8), width = 0.7, alpha = 0.7) +
stat_summary(fun = median, geom = "point", shape = 18, size = 3, color = "black", position = position_dodge(width = 0.8)) +
theme_minimal() +
labs(title = title, x = "Sample Location", y = "ReadsDeduped (capped)") +
theme(legend.position = "bottom")
}
## Function to create boxplot with jitter
create_boxplot_with_jitter <- function(data, title) {
ggplot(data, aes(x = is_wall, y = ReadsDeduped.cap, fill = Species)) +
geom_boxplot(position = position_dodge(width = 0.8), width = 0.7, alpha = 0.7, outlier.shape = NA) +
geom_jitter(aes(color = Species), position = position_jitterdodge(dodge.width = 0.8, jitter.width = 0.2), alpha = 0.5) +
stat_summary(fun = median, geom = "point", shape = 18, size = 3, color = "black", position = position_dodge(width = 0.8)) +
theme_minimal() +
labs(title = title, x = "Sample Location", y = "ReadsDeduped (capped)") +
theme(legend.position = "bottom")
}
## Create separate plots for dog_office and non-dog_office
plot_dog_office <- create_boxplot(dt.tax_filtered[category2 == "dog_office"], "Dog Office: Wall vs No Wall (Boxplot)")
plot_non_dog_office <- create_boxplot(dt.tax_filtered[category2 != "dog_office"], "Non-Dog Office: Wall vs No Wall (Boxplot)")
plot_dog_office_jitter <- create_boxplot_with_jitter(dt.tax_filtered[category2 == "dog_office"], "Dog Office: Wall vs No Wall (Boxplot with Jitter)")
plot_non_dog_office_jitter <- create_boxplot_with_jitter(dt.tax_filtered[category2 != "dog_office"], "Non-Dog Office: Wall vs No Wall (Boxplot with Jitter)")
## Combine plots
combined_plot <- grid.arrange(plot_dog_office, plot_non_dog_office,
plot_dog_office_jitter, plot_non_dog_office_jitter,
ncol = 2)
## Set working directory
setwd("~/github/mpi_dogs/")
## Read in the txt file with dog office and category information
dt.dog_office <- fread('data/dog_samples/R_prep/dog_env_samples_24_v1.txt', na.strings = c('-','NA',''))
## Read in the tsv file with the quicksand data for all samples
dt.tax <- fread('data/env_samples/quicksand.v2/final_report.tsv', na.strings = c('-','NA',''))
## Apply the cap to ReadsDeduped
dt.tax[, ReadsDeduped.cap := pmin(ReadsDeduped, 20000)]
## Merge dt.tax with dt.dog_office to include category information
dt.tax_filtered <- merge(dt.tax, dt.dog_office[, .(sample_id, category, category2)], by="sample_id", all.x=TRUE)
## Filter for only Human (Hominidae) and Dog (Canidae) families
relevant_families <- c('Hominidae', 'Canidae')
dt.tax_filtered <- dt.tax_filtered[Family %in% relevant_families]
## Add wall information and rename families, treating empty categories as "No Wall"
dt.tax_filtered[, `:=`(
is_wall = ifelse(category == "wall", "Wall", "No Wall"),
Species = ifelse(Family == "Hominidae", "Human", "Dog")
)]
dt.tax_filtered[is.na(is_wall) | is_wall == "", is_wall := "No Wall"]
## Function to create boxplot without jitter
create_boxplot <- function(data, title) {
ggplot(data, aes(x = is_wall, y = ReadsDeduped.cap, fill = Species)) +
geom_boxplot(position = position_dodge(width = 0.8), width = 0.7, alpha = 0.7) +
stat_summary(fun = median, geom = "point", shape = 18, size = 3, color = "black", position = position_dodge(width = 0.8)) +
theme_minimal() +
labs(title = title, x = "Sample Location", y = "ReadsDeduped (capped)") +
theme(legend.position = "bottom")
}
## Function to create boxplot with jitter
create_boxplot_with_jitter <- function(data, title) {
ggplot(data, aes(x = is_wall, y = ReadsDeduped.cap, fill = Species)) +
geom_boxplot(position = position_dodge(width = 0.8), width = 0.7, alpha = 0.7, outlier.shape = NA) +
geom_jitter(aes(color = Species), position = position_jitterdodge(dodge.width = 0.8, jitter.width = 0.2), alpha = 0.5) +
stat_summary(fun = median, geom = "point", shape = 18, size = 3, color = "black", position = position_dodge(width = 0.8)) +
theme_minimal() +
labs(title = title, x = "Sample Location", y = "ReadsDeduped (capped)") +
theme(legend.position = "bottom")
}
## Create plots without jitter
plot_dog_office <- create_boxplot(dt.tax_filtered[category2 == "dog_office"], "Dog Office: Wall vs No Wall")
plot_non_dog_office <- create_boxplot(dt.tax_filtered[category2 != "dog_office"], "Non-Dog Office: Wall vs No Wall")
## Combine plots without jitter
combined_plot_no_jitter <- grid.arrange(plot_dog_office, plot_non_dog_office, ncol = 2)
## Save combined plot without jitter
ggsave("figures/walls_vs_no_walls.png", combined_plot_no_jitter, width = 16, height = 8)
## Create plots with jitter
plot_dog_office_jitter <- create_boxplot_with_jitter(dt.tax_filtered[category2 == "dog_office"], "Dog Office: Wall vs No Wall")
plot_non_dog_office_jitter <- create_boxplot_with_jitter(dt.tax_filtered[category2 != "dog_office"], "Non-Dog Office: Wall vs No Wall")
## Combine plots with jitter
combined_plot_with_jitter <- grid.arrange(plot_dog_office_jitter, plot_non_dog_office_jitter, ncol = 2)
## Save combined plot with jitter
ggsave("figures/walls_vs_no_walls_with_jitter.png", combined_plot_with_jitter, width = 16, height = 8)
## Set working directory
setwd("~/github/mpi_dogs/")
## Read in the txt file with dog office and category information
dt.dog_office <- fread('data/dog_samples/R_prep/dog_env_samples_24_v1.txt', na.strings = c('-','NA',''))
## Read in the tsv file with the quicksand data for all samples
dt.tax <- fread('data/env_samples/quicksand.v2/final_report.tsv', na.strings = c('-','NA',''))
## Apply the cap to ReadsDeduped
dt.tax[, ReadsDeduped.cap := pmin(ReadsDeduped, 20000)]
## Merge dt.tax with dt.dog_office to include category information
dt.tax_filtered <- merge(dt.tax, dt.dog_office[, .(sample_id, category, category2)], by="sample_id", all.x=TRUE)
## Filter for only Human (Hominidae) and Dog (Canidae) families
relevant_families <- c('Hominidae', 'Canidae')
dt.tax_filtered <- dt.tax_filtered[Family %in% relevant_families]
## Add wall information and rename families, treating empty categories as "No Wall"
dt.tax_filtered[, `:=`(
is_wall = ifelse(category == "wall", "Wall", "No Wall"),
Species = ifelse(Family == "Hominidae", "Human", "Dog")
)]
dt.tax_filtered[is.na(is_wall) | is_wall == "", is_wall := "No Wall"]
## Function to create boxplot without jitter (log scale)
create_boxplot <- function(data, title) {
ggplot(data, aes(x = is_wall, y = ReadsDeduped.cap, fill = Species)) +
geom_boxplot(position = position_dodge(width = 0.8), width = 0.7, alpha = 0.7) +
stat_summary(fun = median, geom = "point", shape = 18, size = 3, color = "black", position = position_dodge(width = 0.8)) +
scale_y_log10() +
theme_minimal() +
labs(title = title, x = "Sample Location", y = "ReadsDeduped (capped, log10 scale)") +
theme(legend.position = "bottom")
}
## Function to create boxplot with jitter (log scale)
create_boxplot_with_jitter <- function(data, title) {
ggplot(data, aes(x = is_wall, y = ReadsDeduped.cap, fill = Species)) +
geom_boxplot(position = position_dodge(width = 0.8), width = 0.7, alpha = 0.7, outlier.shape = NA) +
geom_jitter(aes(color = Species), position = position_jitterdodge(dodge.width = 0.8, jitter.width = 0.2), alpha = 0.5) +
stat_summary(fun = median, geom = "point", shape = 18, size = 3, color = "black", position = position_dodge(width = 0.8)) +
scale_y_log10() +
theme_minimal() +
labs(title = title, x = "Sample Location", y = "ReadsDeduped (capped, log10 scale)") +
theme(legend.position = "bottom")
}
## Create plots without jitter
plot_dog_office <- create_boxplot(dt.tax_filtered[category2 == "dog_office"], "Dog Office: Wall vs No Wall")
plot_non_dog_office <- create_boxplot(dt.tax_filtered[category2 != "dog_office"], "Non-Dog Office: Wall vs No Wall")
## Combine plots without jitter
combined_plot_no_jitter <- grid.arrange(plot_dog_office, plot_non_dog_office, ncol = 2)
## Read in the txt file with dog office and category information
dt.dog_office <- fread('data/dog_samples/R_prep/dog_env_samples_24_v1.txt', na.strings = c('-','NA',''))
## Read in the tsv file with the quicksand data for all samples
dt.tax <- fread('data/env_samples/quicksand.v2/final_report.tsv', na.strings = c('-','NA',''))
## Apply the cap to ReadsDeduped and add a small constant
dt.tax[, ReadsDeduped.cap := pmin(ReadsDeduped, 20000) + 1]
## Merge dt.tax with dt.dog_office to include category information
dt.tax_filtered <- merge(dt.tax, dt.dog_office[, .(sample_id, category, category2)], by="sample_id", all.x=TRUE)
## Filter for only Human (Hominidae) and Dog (Canidae) families
relevant_families <- c('Hominidae', 'Canidae')
dt.tax_filtered <- dt.tax_filtered[Family %in% relevant_families]
## Add wall information and rename families, treating empty categories as "No Wall"
dt.tax_filtered[, `:=`(
is_wall = ifelse(category == "wall", "Wall", "No Wall"),
Species = ifelse(Family == "Hominidae", "Human", "Dog")
)]
dt.tax_filtered[is.na(is_wall) | is_wall == "", is_wall := "No Wall"]
## Function to create boxplot without jitter (log scale)
create_boxplot <- function(data, title) {
ggplot(data, aes(x = is_wall, y = ReadsDeduped.cap, fill = Species)) +
geom_boxplot(position = position_dodge(width = 0.8), width = 0.7, alpha = 0.7) +
stat_summary(fun = median, geom = "point", shape = 18, size = 3, color = "black", position = position_dodge(width = 0.8)) +
scale_y_log10(labels = scales::comma) +
theme_minimal() +
labs(title = title, x = "Sample Location", y = "ReadsDeduped (capped, log10 scale)") +
theme(legend.position = "bottom")
}
## Function to create boxplot with jitter (log scale)
create_boxplot_with_jitter <- function(data, title) {
ggplot(data, aes(x = is_wall, y = ReadsDeduped.cap, fill = Species)) +
geom_boxplot(position = position_dodge(width = 0.8), width = 0.7, alpha = 0.7, outlier.shape = NA) +
geom_jitter(aes(color = Species), position = position_jitterdodge(dodge.width = 0.8, jitter.width = 0.2), alpha = 0.5) +
stat_summary(fun = median, geom = "point", shape = 18, size = 3, color = "black", position = position_dodge(width = 0.8)) +
scale_y_log10(labels = scales::comma) +
theme_minimal() +
labs(title = title, x = "Sample Location", y = "ReadsDeduped (capped, log10 scale)") +
theme(legend.position = "bottom")
}
## Create plots without jitter
plot_dog_office <- create_boxplot(dt.tax_filtered[category2 == "dog_office"], "Dog Office: Wall vs No Wall")
plot_non_dog_office <- create_boxplot(dt.tax_filtered[category2 != "dog_office"], "Non-Dog Office: Wall vs No Wall")
## Combine plots without jitter
combined_plot_no_jitter <- grid.arrange(plot_dog_office, plot_non_dog_office, ncol = 2)
## Save combined plot without jitter
ggsave("figures/boxplots_no_jitter_log_scale.png", combined_plot_no_jitter, width = 16, height = 8)
## Save combined plot without jitter
ggsave("figures/walls_vs_no_walls.png", combined_plot_no_jitter, width = 16, height = 8)
## Create plots with jitter
plot_dog_office_jitter <- create_boxplot_with_jitter(dt.tax_filtered[category2 == "dog_office"], "Dog Office: Wall vs No Wall")
plot_non_dog_office_jitter <- create_boxplot_with_jitter(dt.tax_filtered[category2 != "dog_office"], "Non-Dog Office: Wall vs No Wall")
## Combine plots with jitter
combined_plot_with_jitter <- grid.arrange(plot_dog_office_jitter, plot_non_dog_office_jitter, ncol = 2)
## Save combined plot with jitter
ggsave("figures/walls_vs_no_walls_with_jitter.png", combined_plot_with_jitter, width = 16, height = 8)
