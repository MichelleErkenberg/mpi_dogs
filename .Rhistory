library("igraph")
# ---- Graph g1 ----
vertices_g1 <- c("a","b","c")
edges_g1 <- c("e1","e2")
adjacencyMatrix_g1 <- matrix(data = c(0,0,1,0,0,1,1,1,0), nrow = 3, byrow = T)
colnames(adjacencyMatrix_g1) = rownames(adjacencyMatrix_g1) = vertices_g1
print(adjacencyMatrix_g1)
g1 <- graph_from_adjacency_matrix(adjacencyMatrix_g1, mode = "undirected")
install.packages("igraph")
library("igraph")
# ---- Graph g1 ----
vertices_g1 <- c("a","b","c")
edges_g1 <- c("e1","e2")
adjacencyMatrix_g1 <- matrix(data = c(0,0,1,0,0,1,1,1,0), nrow = 3, byrow = T)
colnames(adjacencyMatrix_g1) = rownames(adjacencyMatrix_g1) = vertices_g1
print(adjacencyMatrix_g1)
g1 <- graph_from_adjacency_matrix(adjacencyMatrix_g1, mode = "undirected")
plot(g1)
# ---- Graph g2 ----
vertices_g2 <- c("a","b","c", "d", "e")
adjacencyMatrix_g2 <- matrix(data = c(0,1,0,1,0,1,1,2,0,0,0,2,0,1,3,1,0,1,0,1,0,0,3,1,0), nrow = 5, byrow = T)
colnames(adjacencyMatrix_g2) = rownames(adjacencyMatrix_g2) = vertices_g2
print(adjacencyMatrix_g2)
g2 <- graph_from_adjacency_matrix(adjacencyMatrix_g2, mode = "undirected")
plot(g2)
vertices_g3 <- c("a","b","c", "d", "e")
adjacencyMatrix_g3 <- matrix(data = c(0,1,0,1,0,0,1,1,0,0,0,1,0,1,2,0,0,0,0,1,0,0,1,0,0), nrow = 5, byrow = T)
colnames(adjacencyMatrix_g3) = rownames(adjacencyMatrix_g3) = vertices_g3
print(adjacencyMatrix_g3)
g3 <- graph_from_adjacency_matrix(adjacencyMatrix_g3, mode = "directed")
plot(g3)
vertices_g1 <- c("a","b","c")
edges_g1 <- c("e1","e2")
adjacencyMatrix_g1 <- matrix(data = c(0,0,1,0,0,1,1,1,0), nrow = 3, byrow = T)
colnames(adjacencyMatrix_g1) = rownames(adjacencyMatrix_g1) = vertices_g1
print(adjacencyMatrix_g1)
g1 <- graph_from_adjacency_matrix(adjacencyMatrix_g1, mode = "undirected")
plot(g1)
# ---- Graph g2 ----
vertices_g2 <- c("a","b","c", "d", "e")
adjacencyMatrix_g2 <- matrix(data = c(0,1,0,1,0,1,1,2,0,0,0,2,0,1,3,1,0,1,0,1,0,0,3,1,0), nrow = 5, byrow = T)
colnames(adjacencyMatrix_g2) = rownames(adjacencyMatrix_g2) = vertices_g2
print(adjacencyMatrix_g2)
g2 <- graph_from_adjacency_matrix(adjacencyMatrix_g2, mode = "undirected")
plot(g2)
vertices_g4 <- c("a","b","c", "d", "e", "f", "g", "h", "i", "j")
adjacencyMatrix_g4 <- matrix(data = c(2,1,0,1,0,1,1,2,0,0,0,2,3,1,3,1,0,1,0,1,0,0,3,1,1), nrow = 5, byrow = T)
colnames(adjacencyMatrix_g4) = rownames(adjacencyMatrix_g4) = vertices_g4
print(adjacencyMatrix_g4)
g4 <- graph_from_adjacency_matrix(adjacencyMatrix_g4, mode = "undirected")
plot(g4)
adjacencyMatrix_g4 <- matrix(data = c(2,1,0,0,0,1,1,2,0,0,0,2,3,1,0,1,0,1,0,1,0,0,3,1,1), nrow = 5, byrow = T)
colnames(adjacencyMatrix_g4) = rownames(adjacencyMatrix_g4) = vertices_g4
print(adjacencyMatrix_g4)
g4 <- graph_from_adjacency_matrix(adjacencyMatrix_g4, mode = "undirected")
plot(g4)
vertices_g4 <- c("a","b","c", "d", "e", "f", "g", "h", "i", "j")
adjacencyMatrix_g4 <- matrix(data = c(2,1,0,0,0,1,1,2,0,0,0,2,3,1,0,1,0,1,0,1,0,0,3,1,1), nrow = 5, byrow = T)
colnames(adjacencyMatrix_g4) = rownames(adjacencyMatrix_g4) = vertices_g4
print(adjacencyMatrix_g4)
g4 <- graph_from_adjacency_matrix(adjacencyMatrix_g4, mode = "undirected")
plot(g4)
vertices_g3 <- c("a","b","c", "d", "e")
adjacencyMatrix_g3 <- matrix(data = c(0,1,0,1,0,0,1,1,0,0,0,1,0,1,2,0,0,0,0,1,0,0,1,0,0), nrow = 5, byrow = T)
colnames(adjacencyMatrix_g3) = rownames(adjacencyMatrix_g3) = vertices_g3
print(adjacencyMatrix_g3)
g3 <- graph_from_adjacency_matrix(adjacencyMatrix_g3, mode = "directed")
plot(g3)
vertices_g4 <- c("a","b","c", "d", "e", "f", "g", "h", "i", "j")
adjacencyMatrix_g4 <- matrix(data = c(2,1,0,0,0,1,1,2,0,0,0,2,3,1,0,1,0,1,0,1,0,0,3,1,1,2,0,2,1,1,0,1,0,0,0,2), nrow = 10, byrow = T)
colnames(adjacencyMatrix_g4) = rownames(adjacencyMatrix_g4) = vertices_g4
print(adjacencyMatrix_g4)
g4 <- graph_from_adjacency_matrix(adjacencyMatrix_g4, mode = "undirected")
plot(g4)
adjacencyMatrix_g4 <- matrix(data = c(1,1,1,1,1,1,1,1,1,1), nrow = 10, byrow = T)
colnames(adjacencyMatrix_g4) = rownames(adjacencyMatrix_g4) = vertices_g4
print(adjacencyMatrix_g4)
g4 <- graph_from_adjacency_matrix(adjacencyMatrix_g4, mode = "undirected")
plot(g4)
vertices_g1 <- c("a","b","c")
edges_g1 <- c("e1","e2")
adjacencyMatrix_g1 <- matrix(data = c(0,0,1,0,0,1,1,1,0), nrow = 3, byrow = T)
colnames(adjacencyMatrix_g1) = rownames(adjacencyMatrix_g1) = vertices_g1
print(adjacencyMatrix_g1)
g1 <- graph_from_adjacency_matrix(adjacencyMatrix_g1, mode = "undirected")
plot(g1)
# ---- Graph g2 ----
vertices_g2 <- c("a","b","c", "d", "e")
adjacencyMatrix_g2 <- matrix(data = c(0,1,0,1,0,1,1,2,0,0,0,2,0,1,3,1,0,1,0,1,0,0,3,1,0), nrow = 5, byrow = T)
colnames(adjacencyMatrix_g2) = rownames(adjacencyMatrix_g2) = vertices_g2
print(adjacencyMatrix_g2)
g2 <- graph_from_adjacency_matrix(adjacencyMatrix_g2, mode = "undirected")
plot(g2)
adjacencyMatrix_g4 <- matrix(data = c(1,1,1,1,1,1,1,1,1,1,0,1,0,1,0,0,1,1,0,0,0,1,0,1,2,0,0,0,0,1,0,0,1,0,0), nrow = 10, byrow = T)
adjacencyMatrix_g4 <- matrix(data = c(1,1,1,1,1,1,1,1,1,1,0,1,0,1,0,0,1,1,0,0,0,1,0,1,2,0,0,0,0,1,0,0,1,0,0,2,1,3,0,2), nrow = 10, byrow = T)
colnames(adjacencyMatrix_g4) = rownames(adjacencyMatrix_g4) = vertices_g4
print(adjacencyMatrix_g4)
g4 <- graph_from_adjacency_matrix(adjacencyMatrix_g4, mode = "undirected")
plot(g4)
vertices_g4 <- c("a","b","c", "d", "e", "f", "g", "h", "i", "j")
adjacencyMatrix_g4 <- matrix(data = c(1,1,1,1,1,1,1,1,1,1,0,1,0,1,0,0,1,1,0,0,0,1,0,1,2,0,0,0,0,1,0,0,1,0,0,2,1,3,0,2), nrow = 10, byrow = T)
colnames(adjacencyMatrix_g4) = rownames(adjacencyMatrix_g4) = vertices_g4
print(adjacencyMatrix_g4)
g4 <- graph_from_adjacency_matrix(adjacencyMatrix_g4, mode = "undirected")
plot(g4)
adjacencyMatrix_g4 <- matrix(data = c(1,1,1,1,1,1,1,1,1,1,0,1,0,1,0,0,1,1,0,0,0,1,0,1,2,0,0,0,0,1,0,0,1,0,0,2,1,3,0,2,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0,0,1,1,0,0,0,1,0,1,2,0,0,0,0,1,0,0,1,0,0,2,1,3,0,2,1,0,1,0,1,0,0,1,1,0,0,0,1,0,1,2,0,0,0,0,1,0,0,1,0,0,2,1,3,0,2), nrow = 10, byrow = T)
adjacencyMatrix_g4 <- matrix(data = c(1,1,1,1,1,1,1,1,1,1,0,1,0,1,0,0,1,1,0,0,0,1,0,1,2,0,0,0,0,1,0,0,1,0,0,2,1,3,0,2,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0,0,1,1,0,0,0,1,0,1,2,0,0,0,0,1,0,0,1,0,0,2,1,3,0,2,1,0,1,0,1,0,0,1,1,0,0,0,1,0,1,2,0,0,0,0,1,0,0,1), nrow = 10, byrow = T)
adjacencyMatrix_g4 <- matrix(data = c(1,1,1,1,1,1,1,1,1,1,0,1,0,1,0,0,1,1,0,0,0,1,0,1,2,0,0,0,0,1,0,0,1,0,0,2,1,3,0,2,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0,0,1,1,0,0,0,1,0,1,2,0,0,0,0,1,0,0,1,0,0,2,1,3,0,2,1,0,1,0,1,0,0,1,1,0,0,0,1,0,1,2,0,0,0,0), nrow = 10, byrow = T)
colnames(adjacencyMatrix_g4) = rownames(adjacencyMatrix_g4) = vertices_g4
print(adjacencyMatrix_g4)
g4 <- graph_from_adjacency_matrix(adjacencyMatrix_g4, mode = "undirected")
plot(g4)
g1-g4
g1-g3
g1-g2
vertices_g3 <- c("a","b","c", "d", "e")
adjacencyMatrix_g3 <- matrix(data = c(0,1,0,1,0,0,1,1,0,0,0,1,0,1,2,0,0,0,0,1,0,0,1,0,0), nrow = 5, byrow = T)
colnames(adjacencyMatrix_g3) = rownames(adjacencyMatrix_g3) = vertices_g3
print(adjacencyMatrix_g3)
vertices_g4 <- c("a","b","c", "d", "e", "f", "g", "h", "i", "j")
adjacencyMatrix_g4 <- matrix(data = c(1,1,1,1,1,1,1,1,1,1,0,1,0,1,0,0,1,1,0,0,0,1,0,1,2,0,0,0,0,1,0,0,1,0,0,2,1,3,0,2,1,1,1,1,1,1,1,1,1,1,0,1,0,1,0,0,1,1,0,0,0,1,0,1,2,0,0,0,0,1,0,0,1,0,0,2,1,3,0,2,1,0,1,0,1,0,0,1,1,0,0,0,1,0,1,2,0,0,0,0), nrow = 10, byrow = T)
colnames(adjacencyMatrix_g4) = rownames(adjacencyMatrix_g4) = vertices_g4
print(adjacencyMatrix_g4)
vertices_g2 <- c("a","b","c", "d", "e")
adjacencyMatrix_g2 <- matrix(data = c(0,1,0,1,0,1,1,2,0,0,0,2,0,1,3,1,0,1,0,1,0,0,3,1,0), nrow = 5, byrow = T)
colnames(adjacencyMatrix_g2) = rownames(adjacencyMatrix_g2) = vertices_g2
print(adjacencyMatrix_g2)
g2 <- graph_from_adjacency_matrix(adjacencyMatrix_g2, mode = "undirected")
plot(g2)
which_loop(g1)
which_loop(g2)
which_loop(g3)
which_loop(g4)
g <- barabasi.game(10, m=3, algorithm="bag")
any_multiple(g)
which_multiple(g)
count_multiple(g)
which_multiple(simplify(g))
all(count_multiple(simplify(g)) == 1)
which_multiple(g1)
which_multiple(g2)
which_multiple(g2, dir=FALSE)
which_multiple(g2, dir==FALSE)
which_multiple(g2)
g2
adjacent_vertices(g2)
as_adj_list(g2, mode = c("all", "out", "in", "total"))
plot(g2)
as_adj_list(g21, mode = c("all", "out", "in", "total"))
as_adj_list(g1, mode = c("all", "out", "in", "total"))
plot(g1)
#alle
as_adj_list(g3, mode = c("all", "out", "in", "total"))
# ---- Welchen Grad besitzt der Knoten c? ----
g1:
as_adj_list(g1, mode = c("c"))
# ---- Welchen Grad besitzt der Knoten c? ----
g1:
as_adj_list(g1["c"], mode = c("all"))
# ---- Welchen Grad besitzt der Knoten c? ----
g1:
as_adj_list(g1, mode = c("all"))
# ---- Welchen Grad besitzt der Knoten c? ----
g1:
as_adj_list(g1, mode = c("all"))
# ---- Welchen Grad besitzt der Knoten c? ----
g1:
as_adj_list(g1, mode = c("all", "out", "in", "total"))
as_adj_list(g1, mode = c("all", "out", "in", "total"))
a
#c
as_adj_list(g2, mode = c("all", "out", "in", "total"))
#alle
as_adj_list(g3, mode = c("all", "out", "in", "total"))
#alle
as_adj_list(g4, mode = c("all", "out", "in", "total"))
# ---- Welche Grad-Verteilung weist der Graph auf? ----
as_adj_list(g1)
as_adj_edge_list(g1)
# ---- Welche Grad-Verteilung weist der Graph auf? ----
as_adjacency_matrix(
g1,
type = c("both", "upper", "lower"),
attr = NULL,
edges = FALSE,
names = TRUE,
sparse = igraph_opt("sparsematrices")
)
as_adj(
g1,
type = c("both", "upper", "lower"),
attr = NULL,
edges = FALSE,
names = TRUE,
sparse = igraph_opt("sparsematrices")
)
as_data_frame(g1, what = c("vertices"))
is.directed(g1)
is.directed(g2)
is.directed(g3)
is.directed(g4)
is.simple(g1)
is.simple(g2)
is.simple(g3)
is.simple(g4)
table(which_loop(g1)) -> FALSE
table(which_loop(g1))["TRUE"] -> FALSE
which_loop(g1) -> FALSE
which_loop(g1)
table(which_loop(g1))["TRUE"]
table(which_loop(g2))["TRUE"]
table(which_loop(g3))["TRUE"]
table(which_loop(g4))["TRUE"]
as_adj_list(g1, mode = c("all", "out", "in", "total"))
as_adj_list(g1, mode = c("all", "out", "in", "total"))
library(data.table)
library(ggplot2)
library(gridExtra)
## Set working directory
setwd("~/github/mpi_dogs/")
## Read in the txt file with dog office and category information
dt.dog_office <- fread('data/dog_samples/R_prep/dog_env_samples_24_v1.txt', na.strings = c('-','NA',''))
## Filter out samples where category2 contains "lab" or "nc"
dt.dog_office_filtered <- dt.dog_office[!(grepl("lab", category2, ignore.case = TRUE) |
grepl("nc", category2, ignore.case = TRUE))]
## Read in the tsv file with the quicksand data for all samples
dt.tax <- fread('data/env_samples/quicksand.v2/final_report.tsv', na.strings = c('-','NA',''))
## Apply the cap to ReadsDeduped and add a small constant to avoid log scale errors
dt.tax[, ReadsDeduped.cap := pmin(ReadsDeduped, 20000) + 1]
## Merge dt.tax with dt.dog_office_filtered to include category information
dt.tax_filtered <- merge(dt.tax, dt.dog_office_filtered[, .(sample_id, category, category2)], by="sample_id", all.x=TRUE)
## Filter for only Hominidae and Canidae families
relevant_families <- c('Hominidae', 'Canidae')
dt.tax_filtered <- dt.tax_filtered[Family %in% relevant_families]
## Add wall information, treating empty categories as "No Wall"
dt.tax_filtered[, `:=`(
is_wall = ifelse(category == "wall", "Wall", "No Wall")
)]
dt.tax_filtered[is.na(is_wall) | is_wall == "", is_wall := "No Wall"]
## Function to create boxplot without jitter (log scale)
create_boxplot <- function(data, title) {
ggplot(data, aes(x = is_wall, y = ReadsDeduped.cap, fill = Family)) +
geom_boxplot(position = position_dodge(width = 0.8), width = 0.7, alpha = 0.7) +
stat_summary(fun = median, geom = "point", shape = 18, size = 3, color = "black", position = position_dodge(width = 0.8)) +
scale_y_log10(labels = scales::comma) +
theme_minimal() +
labs(title = title, x = "Sample Location", y = "ReadsDeduped (capped, log10 scale)") +
theme(legend.position = "bottom")
}
## Function to create boxplot with jitter (log scale)
create_boxplot_with_jitter <- function(data, title) {
ggplot(data, aes(x = is_wall, y = ReadsDeduped.cap, fill = Family)) +
geom_boxplot(position = position_dodge(width = 0.8), width = 0.7, alpha = 0.7, outlier.shape = NA) +
geom_jitter(aes(color = Family), position = position_jitterdodge(dodge.width = 0.8, jitter.width = 0.2), alpha = 0.5) +
stat_summary(fun = median, geom = "point", shape = 18, size = 3, color = "black", position = position_dodge(width = 0.8)) +
scale_y_log10(labels = scales::comma) +
theme_minimal() +
labs(title = title, x = "Sample Location", y = "ReadsDeduped (capped, log10 scale)") +
theme(legend.position = "bottom")
}
## Create plots without jitter
plot_dog_office <- create_boxplot(dt.tax_filtered[category2 == "dog_office"], "Dog Office: Wall vs No Wall")
plot_non_dog_office <- create_boxplot(dt.tax_filtered[category2 != "dog_office"], "Non-Dog Office: Wall vs No Wall")
## Combine plots without jitter
combined_plot_no_jitter <- grid.arrange(plot_dog_office, plot_non_dog_office, ncol = 2)
## Save combined plot without jitter
ggsave("figures/walls_vs_no_walls.png", combined_plot_no_jitter, width = 16, height = 8)
## Save combined plot without jitter
ggsave("figures/walls_vs_no_walls_without_lab.png", combined_plot_no_jitter, width = 16, height = 8)
## Create plots with jitter
plot_dog_office_jitter <- create_boxplot_with_jitter(dt.tax_filtered[category2 == "dog_office"], "Dog Office: Wall vs No Wall")
plot_non_dog_office_jitter <- create_boxplot_with_jitter(dt.tax_filtered[category2 != "dog_office"], "Non-Dog Office: Wall vs No Wall")
## Combine plots with jitter
combined_plot_with_jitter <- grid.arrange(plot_dog_office_jitter, plot_non_dog_office_jitter, ncol = 2)
## Save combined plot with jitter
ggsave("figures/walls_vs_no_walls_with_jitter_without_lab.png", combined_plot_with_jitter, width = 16, height = 8)
library(data.table)
library(ggplot2)
library(gridExtra)
## Set working directory
setwd("~/github/mpi_dogs/")
## Read in the txt file with dog office and category information
dt.dog_office <- fread('data/dog_samples/R_prep/dog_env_samples_24_v1.txt', na.strings = c('-','NA',''))
## Read in the tsv file with the quicksand data for all samples
dt.tax <- fread('data/env_samples/quicksand.v2/final_report.tsv', na.strings = c('-','NA',''))
## Apply the cap to ReadsDeduped and add a small constant to avoid log scale errors
dt.tax[, ReadsDeduped.cap := pmin(ReadsDeduped, 20000) + 1]
## Merge dt.tax with dt.dog_office to include category information
dt.tax_filtered <- merge(dt.tax, dt.dog_office[, .(sample_id, category, category2)], by="sample_id", all.x=TRUE)
## Filter for only Hominidae and Canidae families
relevant_families <- c('Hominidae', 'Canidae')
dt.tax_filtered <- dt.tax_filtered[Family %in% relevant_families]
## Add wall information, treating empty categories as "No Wall"
dt.tax_filtered[, `:=`(
is_wall = ifelse(category == "wall", "Wall", "No Wall")
)]
dt.tax_filtered[is.na(is_wall) | is_wall == "", is_wall := "No Wall"]
## Function to create boxplot without jitter (log scale)
create_boxplot <- function(data, title) {
ggplot(data, aes(x = is_wall, y = ReadsDeduped.cap, fill = Family)) +
geom_boxplot(position = position_dodge(width = 0.8), width = 0.7, alpha = 0.7) +
stat_summary(fun = median, geom = "point", shape = 18, size = 3, color = "black", position = position_dodge(width = 0.8)) +
scale_y_log10(labels = scales::comma) +
theme_minimal() +
labs(title = title, x = "Sample Location", y = "ReadsDeduped (capped, log10 scale)") +
theme(legend.position = "bottom")
}
## Function to create boxplot with jitter (log scale)
create_boxplot_with_jitter <- function(data, title) {
ggplot(data, aes(x = is_wall, y = ReadsDeduped.cap, fill = Family)) +
geom_boxplot(position = position_dodge(width = 0.8), width = 0.7, alpha = 0.7, outlier.shape = NA) +
geom_jitter(aes(color = Family), position = position_jitterdodge(dodge.width = 0.8, jitter.width = 0.2), alpha = 0.5) +
stat_summary(fun = median, geom = "point", shape = 18, size = 3, color = "black", position = position_dodge(width = 0.8)) +
scale_y_log10(labels = scales::comma) +
theme_minimal() +
labs(title = title, x = "Sample Location", y = "ReadsDeduped (capped, log10 scale)") +
theme(legend.position = "bottom")
}
## Create plots without jitter
plot_dog_office <- create_boxplot(dt.tax_filtered[category2 == "dog_office"], "Dog Office: Wall vs No Wall")
plot_non_dog_office <- create_boxplot(dt.tax_filtered[category2 != "dog_office"], "Non-Dog Office: Wall vs No Wall")
## Combine plots without jitter
combined_plot_no_jitter <- grid.arrange(plot_dog_office, plot_non_dog_office, ncol = 2)
## Save combined plot without jitter
ggsave("figures/walls_vs_no_walls.png", combined_plot_no_jitter, width = 16, height = 8)
## Create plots with jitter
plot_dog_office_jitter <- create_boxplot_with_jitter(dt.tax_filtered[category2 == "dog_office"], "Dog Office: Wall vs No Wall")
plot_non_dog_office_jitter <- create_boxplot_with_jitter(dt.tax_filtered[category2 != "dog_office"], "Non-Dog Office: Wall vs No Wall")
## Combine plots with jitter
combined_plot_with_jitter <- grid.arrange(plot_dog_office_jitter, plot_non_dog_office_jitter, ncol = 2)
## Save combined plot with jitter
ggsave("figures/walls_vs_no_walls_with_jitter.png", combined_plot_with_jitter, width = 16, height = 8)
